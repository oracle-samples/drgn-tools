.\" Generated by scdoc 1.11.2
.\" Complete documentation for this program is not available as a GNU info page
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.nh
.ad l
.\" Begin generated content:
.TH "CORELENS" "1" "2024-04-12"
.P
.P
.SH NAME
.P
corelens - extract diagnostic info from the running kernel or core dump
.P
.SH SYNOPSIS
.P
Generate a corelens report:
.P
.RS 4
\fBcorelens\fR [-o OUT] \fIVMCORE\fR [-a | -A]
.P
.RE
Run specified modules:
.P
.RS 4
\fBcorelens\fR [-o OUT] \fIVMCORE\fR [-M MODULE [options] [-M MODULE .\&.\&.\&]]
.P
.RE
Get help:
.P
.RS 4
\fBcorelens -h\fR
.P
\fBcorelens -L\fR
.P
\fBcorelens -M\fR \fIMODULE\fR \fB-h\fR
.P
.RE
.SH DESCRIPTION
.P
Corelens is a tool which can extract diagnostic information from the Linux
kernel image specified by \fIVMCORE\fR.\& To extract diagnostic information from the
running kernel, "/proc/kcore" should be provided.\&  Its functionality is grouped
into \fImodules\fR, each one producing diagnostic information about a specific
kernel subsystem.\&
.P
Corelens may be run in two modes: generating a report, or running specified
modules.\& When generating a report, corelens will run a collection of default
modules, with default arguments.\& Alternatively, the user may run a list of
specified modules.\& Each module must be specified on the command line with
\fB-M\fR \fIMODULE\fR, and any subsequent argument (up to the next \fB-M\fR) is handled by
\fIMODULE\fR.\&
.P
By default, corelens produces output on stdout.\& However, with \fB-o\fR, output may
be stored in a directory, where each module'\&s output is contained in a separate
file.\& This mode is useful when preparing a report to send to Oracle Linux
Support.\&
.P
.SH OPTIONS
.P
\fIVMCORE\fR
.RS 4
The kernel image to run against.\& Specify "/proc/kcore" for the running
kernel.\& This argument is required, unless using \fB-h\fR to get help, or
\fB-L\fR to list corelens modules.\&
.P
.RE
\fB--output-directory\fR \fIOUT\fR, \fB-o\fR \fIOUT\fR
.RS 4
Write each module'\&s output to a correspondingly named file within the
\fIOUT\fR directory.\& The directory \fIOUT\fR will be created if it does not
exist.\&
.P
.RE
\fBMode selection:\fR
.P
.RS 4
The following options are mutually exclusive.\&
.P
\fB-a\fR
.RS 4
When specified, this runs the default corelens report, which should be
sufficient for most cases.\& All standard modules are selected to be run
with their default arguments.\& Modules which are not applicable (e.\&g.\&
because the subsystem is not loaded or active) are skipped.\&
.P
.RE
\fB-A\fR
.RS 4
When specified, this runs the detailed corelens report.\& This selects all
modules, including those which are not run by \fB-a\fR.\& These detailed
modules may produce larger amounts of output, or require a longer
runtime.\& The standard report provided by \fB-a\fR should be preferred.\&
.P
.RE
\fB-M\fR \fIMODULE\fR [.\&.\&.\&]
.RS 4
Specify a corelens module to run, providing optional arguments to the
module itself.\& All command-line arguments following this one are
provided to the module, up to the next \fB-M\fR option.\&
.P
As a special case, when using \fB-h\fR to get help on a module'\&s
output, \fIVMCORE\fR is not required.\&
.P
.RE
\fB-L\fR
.RS 4
List all modules and exit.\& \fIVMCORE\fR is not required.\&
.P
.RE
As a special case, when corelens is run without any of the above mode
selection arguments, it runs the "sys" corelens module (as if the
arguments provided were: \fB-M sys\fR).\&
.P
.RE
\fBDebuginfo Selection:\fR
.P
.RS 4
The following options disable the standard behavior for searching for
debuginfo, and manually provide it.\& They are not required.\& They are
mutually exclusive to each other.\&
.P
\fB--ctf\fR \fICTF\fR
.RS 4
Corelens will manually load the CTF file \fICTF\fR.\&
.P
.RE
\fB--debuginfo\fR \fIDEBUGINFO\fR, \fB-d\fR \fIDEBUGINFO\fR
.RS 4
Corelens will search for DWARF debuginfo within the directory
\fIDEBUGINFO\fR, which should contain a "vmlinux" file as well as
".\&ko.\&debug" files for each relevant kernel module.\&
.P
.RE
.RE
.SH DEBUGINFO
.P
In order to produce diagnostic information, corelens requires some form of
debugging information for \fIVMCORE\fR.\& There are two possibilities:
.P
\fBDWARF\fR
.RS 4
DWARF information is the most detailed option, but it requires that the
\fB-debuginfo\fR package corresponding to \fIVMCORE\fR is installed.\& When DWARF
information is available, corelens can provide more detailed stack
traces, and some modules only work when DWARF is available.\&
.P
.RE
\fBCTF\fR
.RS 4
CTF (Compact Type Format) is a lightweight type format.\& For Oracle UEK
kernels (\fBkernel-uek\fR), CTF is always available.\&
.P
.RE
Corelens automatically searches for debuginfo at startup.\& It prefers DWARF when
available, and uses CTF as a second choice.\& The search may be overridden by
using the options \fB--ctf\fR or \fB--debuginfo\fR.\&
.P
.SH MODULES
.P
Corelens'\& functionality is divided into modules.\& Modules have a name and can
accept command-line arguments.\& They are broken into three categories based on
when they are run:
.P
.RS 4
.ie n \{\
\h'-04'1.\h'+03'\c
.\}
.el \{\
.IP 1. 4
.\}
Standard modules run whenever \fB-a\fR is specified
.RE
.RS 4
.ie n \{\
\h'-04'2.\h'+03'\c
.\}
.el \{\
.IP 2. 4
.\}
Detailed modules are run whenever \fB-A\fR is specified
.RE
.RS 4
.ie n \{\
\h'-04'3.\h'+03'\c
.\}
.el \{\
.IP 3. 4
.\}
Manual modules are only run when explicitly requested

.RE
.P
Some corelens modules will only run if a relevant kernel module is loaded.\&
Others require DWARF debuginfo.\& Some modules may only run against core dumps
(not /proc/kcore).\& Corelens will provide appropriate warnings or errors at
runtime if these situations are encountered.\&
.P
The full list of modules can be viewed by running \fBcorelens -L\fR.\& To view more
information about a specific module, including its command-line arguments, you
can run \fBcorelens -M\fR \fIMODULE\fR \fB-h\fR.\&
.P
.SH EXAMPLES
.P
Run the "sys" module against the live kernel:
.P
.nf
.RS 4
corelens /proc/kcore -M sys
.fi
.RE
.P
Run a default report against a live kernel, and store the report in a directory.\&
Then create an archive for later transmission to Oracle Linux Support:
.P
.nf
.RS 4
corelens /proc/kcore -a -o \&./report
tar -cvzf report\&.tar\&.gz \&./report
.fi
.RE
.P
List all modules:
.P
.nf
.RS 4
corelens -L
.fi
.RE
.P
Get help on the dentrycache module:
.P
.nf
.RS 4
corelens -M dentrycache -h
.fi
.RE
.P
.SH REPORTING BUGS
.P
Please contact Oracle Linux Support to report any bugs for corelens.\&
